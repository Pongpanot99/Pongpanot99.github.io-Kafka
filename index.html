<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <title> Kafka </title>'
  <style>
    /* รีเซ็ต margin/padding */
    body, html {margin: 0;padding: 0;overflow: hidden; /* ป้องกันการเลื่อน */width: 100%;height: 100%;
    }

    canvas {display: block; width: 100vw;   /* เต็มหน้าจอแนวนอน */ height: 100vh;  /* เต็มหน้าจอแนวตั้ง */
    }
  </style>
</head>
<body>
    <!-- core three.js -->
    
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dat.gui/build/dat.gui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/RGBELoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/MTLLoader.js"></script>

    <script>
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;
document.body.appendChild(renderer.domElement);

const scene = new THREE.Scene();

// Camera
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(1.5, 2, -3.2);
camera.lookAt(0, 1, 0);
const controls = new THREE.OrbitControls(camera, renderer.domElement);

// Materials
const material2 = new THREE.MeshStandardMaterial({ color: 0xFFD700, metalness: 0.9, roughness: 0.2 });
const material3 = new THREE.MeshStandardMaterial({ color: 0xd2cbd2, metalness: 0.1, roughness: 0.5 });
const material4 = new THREE.MeshStandardMaterial({ color: 0x111111, metalness: 0.7, roughness: 0.3 });

// Floor
const planeGeometry = new THREE.PlaneGeometry(20, 20);
const plane = new THREE.Mesh(planeGeometry, material3);
plane.rotation.x = -Math.PI/2;
plane.position.y = 0;
plane.receiveShadow = true;
scene.add(plane);

       const texLoader = new THREE.TextureLoader();
const texList = [
    texLoader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/Image_5.png"), 
    texLoader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/Image_1.png"), 
    texLoader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/Image_2.png"), 
    texLoader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/Image_5.png"), 
    texLoader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/Image_3.png"), 
    texLoader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/Image_4.png"), 
];

// โหลด OBJ แล้วแมป texture ตาม index
const loader = new THREE.OBJLoader();
loader.load("https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/kafka2.obj", (object) => {
    let i = 0;
    object.traverse((child) => {
        if (child.isMesh) {
            child.castShadow = true;
            child.receiveShadow = true;

            if (texList[i]) {  // ป้องกันกรณี mesh มากกว่า texture
                child.material = new THREE.MeshStandardMaterial({
                    map: texList[i] ,metalness: 0.1, roughness: 0.5
                });
            }

            i++;
        }
    });
    scene.add(object);
});

loader.load('https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/sword.obj',
  (object2) => {
    object2.traverse((child) => {
      if (child.isMesh) {
        child.castShadow = true;
        child.receiveShadow = true;
        child.material = material2;
      }
    });
    scene.add(object2);
  }
);

// ✅ โหลด jail.obj
loader.load('https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/jail.obj',
  (object3) => {
    object3.traverse((child) => {
      if (child.isMesh) {
        child.castShadow = true;
        child.receiveShadow = true;
        child.material = material4;
      }
    });
    scene.add(object3);
  }
);

// Lights
const directionalLight = new THREE.DirectionalLight(0xffeedd, 0.9);
directionalLight.position.set(10, 5, 10);
directionalLight.castShadow = true;
scene.add(directionalLight);

const pointLight = new THREE.PointLight(0xffeedd, 1);
pointLight.position.set(0, 0, 0);
pointLight.castShadow = true;
scene.add(pointLight);

// GUI
const gui = new dat.GUI();
const directionalLightFolder = gui.addFolder('Directional Light');
directionalLightFolder.add(directionalLight, 'intensity', 0, 2);
directionalLightFolder.add(directionalLight.position, 'x', -100, 100);
directionalLightFolder.add(directionalLight.position, 'y', -100, 100);
directionalLightFolder.add(directionalLight.position, 'z', -100, 100);

const pointLightFolder = gui.addFolder('Point Light');
pointLightFolder.add(pointLight, 'intensity', 0, 2);
pointLightFolder.add(pointLight.position, 'x', -100, 100);
pointLightFolder.add(pointLight.position, 'y', -100, 100);
pointLightFolder.add(pointLight.position, 'z', -100, 100);

// HDRI
const pmremGenerator = new THREE.PMREMGenerator(renderer);
pmremGenerator.compileEquirectangularShader();

new THREE.RGBELoader()
  .setDataType(THREE.UnsignedByteType)
  .load('https://raw.githubusercontent.com/Pongpanot99/Pongpanot99.github.io-Kafka/main/studio_small_08_2k.hdr',
    (hdrTexture) => {
      const envMap = pmremGenerator.fromEquirectangular(hdrTexture).texture;
      scene.background = envMap;
      scene.environment = envMap;
      hdrTexture.dispose();
      pmremGenerator.dispose();
    }
  );

function animate() {
  renderer.render(scene, camera);
  requestAnimationFrame(animate);
}
animate();
</script>
</body>

</html>
